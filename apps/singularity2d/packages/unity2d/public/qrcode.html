<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Code with Image and Circle</title><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</head>

<body
    style="width: 100%;height:100%;display:flex;flex-direction: row;justify-content: space-around;align-items: centers;text-align: center;">
    <section style="display: grid;grid-template-columns: repeat(2,1fr);">
        <div id="myCanvas3" width="256" height="256"></div>
        <div id="myCanvas2" width="256" height="256"></div>
        <div id="myCanvas1" width="256" height="256"></div>
        <div id="myCanvas0" width="256" height="256"></div>
        <div id="myCanvas" width="256" height="256"></div>
    </section>
    <!-- <section>
        QR
        <div id="qr-reader" width="600px" style="display: none;"></div>
    </section> -->
    
    <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
    <!-- <canvas id="myCanvas" width="256" height="256"></canvas> -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script type="module">
        import { HDNodeWallet } from "./modules/ethers/ethers.min.js";
        import generateQRCodeCanvas from '/bin/generateQRCodeCanvas.js'
        // Example usagef
        const signer = HDNodeWallet.createRandom();
        generateQRCodeCanvas(document.getElementById('myCanvas3'), 'Your QR Code Content', 'src/images/input.png',true,true);
        generateQRCodeCanvas(document.getElementById('myCanvas2'), signer.extendedKey, '/src/images/input.png', false);
        generateQRCodeCanvas(document.getElementById('myCanvas1'), 'Your QR Code Content', '/src/images/input.png', true);
        generateQRCodeCanvas(document.getElementById('myCanvas0'), undefined, 'src/images/input.png',true);
        generateQRCodeCanvas(document.getElementById('myCanvas'), 'Your QR Code Content');
    </script>
    <!-- <script type="module">
        const qrElements = ['myCanvas2', 'myCanvas1', 'myCanvas0', 'myCanvas'];
        qrElements.forEach(id => {
            document.getElementById(id).addEventListener("click", () => {
                document.getElementById('qr-reader').style.display = 'block';
                startQRScanner(id);
            });
        });

        // function startQRScanner() {
        //     const qrScanner = new Html5Qrcode("qr-reader");
        //     qrScanner.start({ facingMode: "environment" }, {
        //         fps: 10,
        //         qrbox: 250
        //     }, qrCodeMessage => {
        //         alert(`QR Code detected: ${qrCodeMessage}`);
        //         qrScanner.stop().then(() => {
        //             document.getElementById('qr-reader').style.display = 'none';
        //         }).catch(err => {
        //             console.error(err);
        //         });
        //     }).catch(err => {
        //         console.error(err);
        //     });
        // }
        function startQRScanner(id) {
            function onScanSuccess(decodedText, decodedResult) {
                alert(`QR Code detected: ${decodedText}`);
                generateQRCodeCanvas(document.getElementById(id), decodedText,'/src/images/input.png');
                // handle the scanned code as you like, for example:
                console.log(`Code matched = ${decodedText}`, decodedResult);
                html5QrcodeScanner.clear()
            }

            function onScanFailure(error) {
                // handle scan failure, usually better to ignore and keep scanning.
                // for example:
                console.warn(`Code scan error = ${error}`);
            }

            let html5QrcodeScanner = new Html5QrcodeScanner(
                "qr-reader",
                { fps: 10, qrbox: { width: 256, height: 256 } },
  /* verbose= */ false);
            html5QrcodeScanner.render(onScanSuccess, onScanFailure);

            // const qrScanner = new Html5Qrcode("qr-reader");

            // qrScanner.start({ facingMode: "environment" }, {
            //     fps: 10,
            //     qrbox: 250
            // }, qrCodeMessage => {
            //     alert(`QR Code detected: ${qrCodeMessage}`);
            //     qrScanner.stop().then(() => {
            //         document.getElementById('qr-reader').style.display = 'none';
            //     }).catch(err => {
            //         console.error(err);
            //     });
            // }).catch(err => {
            //     console.error(err);
            // });
        }
    </script> -->
</body>

</html>